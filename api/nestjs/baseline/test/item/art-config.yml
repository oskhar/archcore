config:
  # Ganti dengan URL aplikasi NestJS Anda yang sedang berjalan
  target: 'http://localhost:3000'

  phases:
    # Fase 1: Pemanasan (Warm up)
    # Selama 30 detik, kirim 5 user baru setiap detik.
    - duration: 30
      arrivalRate: 5
      name: 'Warm up'

    # Fase 2: Peningkatan Beban (Ramp up)
    # Selama 60 detik, naikkan beban dari 5 user/detik menjadi 50 user/detik secara bertahap.
    - duration: 60
      arrivalRate: 5
      rampTo: 50
      name: 'Ramp up load'

    # Fase 3: Beban Tinggi Stabil (Sustained High Load)
    # Selama 2 menit (120 detik), pertahankan beban konstan di 50 user/detik.
    - duration: 120
      arrivalRate: 50
      name: 'Sustained high load'

  # Load plugin (opsional, misalnya untuk monitoring)
  plugins:
    ensure: {}
    # metrics-by-endpoint: {}

  # Menetapkan batas kelulusan (Thresholds)
  # Test gagal jika latensi p95 > 500ms atau error rate > 1%
  ensure:
    p95: 500
    maxErrorRate: 1

scenarios:
  - name: 'Get Items List'
    flow:
      # Skenario 1: Hit endpoint GET /item
      - get:
          url: '/item'

      # Opsional: Beri jeda 1 detik sebelum request berikutnya (simulasi user berpikir)
      # - think: 1

      # Skenario 2 (Opsional): Hit detail item acak
      # - get:
      #     url: "/item/1"
